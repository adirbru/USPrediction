2025-11-20 23:37:53,385 - INFO - Using device: cuda:0
2025-11-20 23:37:53,385 - INFO - Loaded in-place augmentation: quantize
2025-11-20 23:37:53,385 - INFO - Loaded in-place augmentation: resize
2025-11-20 23:37:53,385 - INFO - Processing videos to extract frames...
2025-11-20 23:37:54,035 - INFO - Dataset initialized with 25 video pairs.
2025-11-20 23:37:54,036 - INFO - Train samples: 18499, Val samples: 3421
2025-11-20 23:37:54,269 - INFO - Using class weights: [0.1 1.  1.  1.  1.  1.  1.  1. ]
2025-11-20 23:37:54,270 - INFO - 
============================================================
Starting Training for 10 Epochs
============================================================
2025-11-20 23:37:54,270 - INFO - 
--- Epoch 1/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:22<00:00, 28.03it/s]
2025-11-20 23:39:16,779 - INFO - Epoch 1 Train - Loss: 0.1796, Accuracy: 0.9416, Precision: 0.8930, Recall: 0.9408
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:07<00:00, 56.38it/s]
2025-11-20 23:39:24,371 - INFO - Epoch 1 Val   - Loss: 0.7554, Accuracy: 0.8213, Precision: 0.7040, Recall: 0.8053
2025-11-20 23:39:24,372 - INFO - New best model saved.
2025-11-20 23:39:24,372 - INFO - 
--- Epoch 2/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:22<00:00, 28.05it/s]
2025-11-20 23:40:46,830 - INFO - Epoch 2 Train - Loss: 0.0775, Accuracy: 0.9712, Precision: 0.9342, Recall: 0.9648
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:08<00:00, 53.45it/s]
2025-11-20 23:40:54,839 - INFO - Epoch 2 Val   - Loss: 0.9281, Accuracy: 0.8124, Precision: 0.6898, Recall: 0.8009
2025-11-20 23:40:54,839 - INFO - 
--- Epoch 3/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:23<00:00, 27.84it/s]
2025-11-20 23:42:17,932 - INFO - Epoch 3 Train - Loss: 0.0699, Accuracy: 0.9739, Precision: 0.9397, Recall: 0.9671
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:08<00:00, 52.41it/s]
2025-11-20 23:42:26,100 - INFO - Epoch 3 Val   - Loss: 0.9395, Accuracy: 0.8181, Precision: 0.6968, Recall: 0.8043
2025-11-20 23:42:26,100 - INFO - 
--- Epoch 4/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:24<00:00, 27.47it/s]
2025-11-20 23:43:50,288 - INFO - Epoch 4 Train - Loss: 0.0658, Accuracy: 0.9754, Precision: 0.9428, Recall: 0.9685
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:08<00:00, 50.98it/s]
2025-11-20 23:43:58,686 - INFO - Epoch 4 Val   - Loss: 1.1263, Accuracy: 0.8054, Precision: 0.6896, Recall: 0.7854
2025-11-20 23:43:58,686 - INFO - 
--- Epoch 5/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:24<00:00, 27.44it/s]
2025-11-20 23:45:22,967 - INFO - Epoch 5 Train - Loss: 0.0627, Accuracy: 0.9766, Precision: 0.9452, Recall: 0.9696
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:07<00:00, 53.54it/s]
2025-11-20 23:45:30,962 - INFO - Epoch 5 Val   - Loss: 1.0814, Accuracy: 0.8082, Precision: 0.6900, Recall: 0.7953
2025-11-20 23:45:30,962 - INFO - 
--- Epoch 6/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:24<00:00, 27.46it/s]
2025-11-20 23:46:55,202 - INFO - Epoch 6 Train - Loss: 0.0601, Accuracy: 0.9776, Precision: 0.9473, Recall: 0.9705
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:08<00:00, 53.24it/s]
2025-11-20 23:47:03,243 - INFO - Epoch 6 Val   - Loss: 1.2479, Accuracy: 0.7979, Precision: 0.6837, Recall: 0.7898
2025-11-20 23:47:03,243 - INFO - 
--- Epoch 7/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:24<00:00, 27.29it/s]
2025-11-20 23:48:28,011 - INFO - Epoch 7 Train - Loss: 0.0578, Accuracy: 0.9785, Precision: 0.9491, Recall: 0.9714
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:08<00:00, 52.29it/s]
2025-11-20 23:48:36,198 - INFO - Epoch 7 Val   - Loss: 1.2793, Accuracy: 0.8018, Precision: 0.6870, Recall: 0.7797
2025-11-20 23:48:36,198 - INFO - 
--- Epoch 8/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:24<00:00, 27.27it/s]
2025-11-20 23:50:01,005 - INFO - Epoch 8 Train - Loss: 0.0557, Accuracy: 0.9794, Precision: 0.9509, Recall: 0.9722
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:08<00:00, 52.65it/s]
2025-11-20 23:50:09,135 - INFO - Epoch 8 Val   - Loss: 1.3898, Accuracy: 0.7960, Precision: 0.6804, Recall: 0.7758
2025-11-20 23:50:09,135 - INFO - 
--- Epoch 9/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:24<00:00, 27.26it/s]
2025-11-20 23:51:33,986 - INFO - Epoch 9 Train - Loss: 0.0540, Accuracy: 0.9801, Precision: 0.9525, Recall: 0.9728
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:08<00:00, 52.27it/s]
2025-11-20 23:51:42,176 - INFO - Epoch 9 Val   - Loss: 1.4514, Accuracy: 0.7985, Precision: 0.6861, Recall: 0.7739
2025-11-20 23:51:42,176 - INFO - 
--- Epoch 10/10 ---
Train: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2313/2313 [01:24<00:00, 27.25it/s]
2025-11-20 23:53:07,046 - INFO - Epoch 10 Train - Loss: 0.0522, Accuracy: 0.9808, Precision: 0.9541, Recall: 0.9735
Val  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 428/428 [00:08<00:00, 51.23it/s]
2025-11-20 23:53:15,401 - INFO - Epoch 10 Val   - Loss: 1.4817, Accuracy: 0.7977, Precision: 0.6895, Recall: 0.7707
2025-11-20 23:53:15,509 - INFO - 
Saved best model (val_loss: 0.7554) to ./best_unet.pth
2025-11-20 23:53:15,509 - INFO - 
============================================================
2025-11-20 23:53:15,509 - INFO - TRAINING SUMMARY
2025-11-20 23:53:15,509 - INFO - ============================================================
2025-11-20 23:53:15,509 - INFO - Training subjects: ['01', '04', '06', '10', '17', '19', '20', '21', '23', '24'] (10 subjects)
2025-11-20 23:53:15,509 - INFO - Validation subjects: ['05', '25'] (2 subjects)
2025-11-20 23:53:15,509 - INFO - Training samples: 18499
2025-11-20 23:53:15,509 - INFO - Validation samples: 3421
2025-11-20 23:53:15,509 - INFO - 
Final Training Metrics:
2025-11-20 23:53:15,509 - INFO -   Loss:      0.0522
2025-11-20 23:53:15,509 - INFO -   Accuracy:  0.9808
2025-11-20 23:53:15,509 - INFO -   Precision: 0.9541
2025-11-20 23:53:15,509 - INFO -   Recall:    0.9735
2025-11-20 23:53:15,509 - INFO - \Best Validation Metrics:
2025-11-20 23:53:15,509 - INFO -   Loss:      0.7554
2025-11-20 23:53:15,509 - INFO -   Accuracy:  0.8213
2025-11-20 23:53:15,509 - INFO -   Precision: 0.7040
2025-11-20 23:53:15,509 - INFO -   Recall:    0.8053
2025-11-20 23:53:15,509 - INFO - 
Best validation loss: 0.7554
2025-11-20 23:53:15,509 - INFO - 
Training complete!